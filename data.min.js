function liveSearch(search_input) {
    $.ajax({
        type: 'POST',
        url: '/api/anime/getPost',
        beforeSend: function() {
            var html = '';
            html = '<div class="loader"></div>';
            $('#search_list_mobile').html(html);
            $('#search_list').html(html);
        },
        data: {
            post: search_input
        },
        dataType: 'json',
        success: function(data) {
            console.log(data);
            var html = '';
            var i;
            if (data == "") {
                html += '<div class="search-list">' +
                            '<div class="p-2 text-center text-white">' +
                                '<p class="m-0">Data Not Found</p>' +
                            '</div>'+
                        '</div>';
            } else {
                html += '<div class="search-list p-2">';
                for (i = 0; i < data.length; i++) {
                    html += '<a class="link-show" href="/show/' + data[i].post_url + '">' +
                        '<div class="data-grid d-flex mb-1">' +
                        '<img class="img-fluid lazyload" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNUVNXcBAACAQEj60RLPwAAAABJRU5ErkJggg==" data-src="/images/posts/90/' + data[i].post_image + '" alt="' + data[i].post_name + '" onError="this.onerror=null;this.src=https://dummyimage.com/90x90/fff/000&text=NoImage" width="90" height="90">' +
                        '<div class="col-8 px-2">' +
                        '<p class="m-0 sub-str">' + data[i].post_name + '</p>' +
                        '<p class="m-0 sub-str">Episode ' + data[i].post_episodes + '</small></p>' +
                        '<p class="m-0 sub-str">Rate : <i class="fa fa-star text-warning"></i> ' + data[i].post_rate + '</small></p>' +
                        '</div>' +
                        '</div>' +
                        '</a>';
                }
                html += '</div>';
            }
            $('#search_list_mobile').html(html);
            $('#search_list').html(html);
        }
    })
}

$(document).ready(function() {
    $("#search_input").keyup(function(event) {
        var search_input = $("#search_input").val();
        if (event.keyCode == "13") {
            window.location = "/search/" + search_input
        }
    });
    $("#search_input_mobile").keyup(function() {
        var search_input = $("#search_input_mobile").val();
        if (event.keyCode == "13") {
            window.location = "/search/" + search_input
        }
    });
    $("#search_input").bind("input", function(event) {
        var search_input = $("#search_input").val();
        if (event.keyCode == "13") {
            window.location = "/search/" + search_input
        }
            if (search_input != "") {
                liveSearch(search_input)
            } else {
                $("#search_list").html("")
            }
    });
    $("#search_input_mobile").bind("input", function() {
        var search_input = $("#search_input_mobile").val();
        if (event.keyCode == "13") {
            window.location = "/search/" + search_input
        }
            if (search_input != "") {
                liveSearch(search_input)
            } else {
                $("#search_list_mobile").html("")
            }
        
    });
    $("#btn-search").click(function() {
        var query = $("#search_input").val();
        window.location = "/search/" + query
    });
    $("#btn-search-mobile").click(function() {
        var query = $("#search_input_mobile").val();
        window.location = "/search/" + query
    })
});